<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dio Config</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
            margin: 0;
            position: relative;
        }
        /* Sidebar container */
        .sidebar {
            display: block;
            position: fixed;
            width: 400px;
            height: 100vh;
            background: #ffffff;
            border-left: 2px solid #dee2e6;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
        }
        .sidebar.active { animation: slideInRight 0.3s ease-out; }
        .sidebar.closing { animation: slideOutRight 0.3s ease-in; }
        @keyframes slideInRight { from{transform:translateX(100%)} to{transform:translateX(0)} }
        @keyframes slideOutRight { from{transform:translateX(0)} to{transform:translateX(100%)} }

        /* Pin header */
        .pin-info h4{margin:0 0 6px}
        .pin-info p{margin:4px 0;color:#333}

        /* Advanced Settings Styles */
        .form-group { margin-bottom: 15px; }
        .form-group label { display:block; font-weight:600; margin-bottom:5px; color:#333; font-size:13px }
        .form-group input, .form-group select { width:100%; padding:8px 12px; border:1px solid #ddd; border-radius:4px; font-size:13px; box-sizing:border-box }
        .form-group input:focus, .form-group select:focus { outline:none; border-color:#007acc; box-shadow:0 0 0 2px rgba(0,122,204,0.1) }
        .form-group small { display:block; color:#666; font-size:11px; margin-top:4px }

        .collapsible-header { background:#e9ecef; padding:10px 15px; margin:10px 0 5px 0; border-radius:4px; cursor:pointer; user-select:none }
        .collapsible-header h4{margin:0; font-size:14px; color:#495057; display:flex; justify-content:space-between; align-items:center }
        .toggle-icon { transition: transform 0.2s ease }
        .collapsible-header.collapsed .toggle-icon { transform: rotate(-90deg) }

        .collapsible-content { padding:0 10px; max-height:1000px; overflow:hidden; transition:max-height 0.3s ease }
        .collapsible-content.collapsed { max-height:0; padding:0 10px }

        .button-row { margin-top:20px; display:flex; gap:10px; flex-wrap:wrap }
        .btn { padding:8px 16px; border:none; border-radius:4px; font-size:12px; cursor:pointer }
        .btn-primary{ background:#007acc; color:white }
        .btn-secondary{ background:#6c757d; color:white }
        .btn-info{ background:#17a2b8; color:white }
        .btn-success{ background:#28a745; color:white }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="pin-info">
            <h4>Pin ${config.pin} - ${config.shortName}</h4>
            <p><strong>Type:</strong> ${config.outputType}</p>
            <p><strong>Original Label:</strong> ${config.originalLabel}</p>
        </div>
        
        <!-- Basic Configuration -->
        <div class="form-group">
            <label for="rba_IoSigDio_0CustSpecName">Customer Specific Name (Short Name):</label>
            <input type="text" id="rba_IoSigDio_0CustSpecName" name="custSpecName" 
                value="${config.shortName}" placeholder="Custom signal name">
            <small>Customer-specific name for documentation</small>
        </div>

        <div class="form-group">
            <label for="dio-direction">Direction *:</label>
            <select id="dio-direction" name="direction" required>
                <option value="Output" selected>Output</option>
                <option value="Input">Input</option>
            </select>
            <small>Signal direction (Input/Output)</small>
        </div>

        <div class="form-group">
            <label for="rba_IoSigDio_1ConnectedTo">Connected To *:</label>
            <input type="text" id="rba_IoSigDio_1ConnectedTo" name="connectedTo" 
                placeholder="DevType_DevOrPortIdx_Pin" 
                pattern="^[A-Z][A-Za-z0-9]*?_.*"
                title="Format: DevType_DevOrPortIdx_Pin" value="${VD1CC055.getIcByPin(config.pin)}" required>
            <small>Device and pin connection specification</small>
        </div>
        
        <!-- Advanced Configuration -->
        <div class="collapsible-header" data-target="signal-control">
            <h4>Signal Control <span class="toggle-icon">▼</span></h4>
        </div>
        <div class="collapsible-content collapsed" id="signal-control">
            <div class="form-group">
                <label for="rba_IoSigDio_1DirectionChangeable">Direction Changeable:</label>
                <select id="rba_IoSigDio_1DirectionChangeable" name="directionChangeable">
                    <option value="true">TRUE</option>
                    <option value="false" selected>FALSE</option>
                </select>
                <small>Enable runtime direction change</small>
            </div>
            
            <div class="form-group">
                <label for="rba_IoSigDio_1Invert">Signal Inversion:</label>
                <select id="rba_IoSigDio_1Invert" name="invert">
                    <option value="true">TRUE</option>
                    <option value="false" selected>FALSE</option>
                </select>
                <small>Invert signal polarity (negative logic)</small>
            </div>
        </div>
        
        <div class="collapsible-header" data-target="calibration-settings">
            <h4>Calibration Settings <span class="toggle-icon">▼</span></h4>
        </div>
        <div class="collapsible-content collapsed" id="calibration-settings">
            <div class="form-group">
                <label for="rba_IoSigDio_Calibratable">Calibration Routing Support:</label>
                <select id="rba_IoSigDio_Calibratable" name="calibratable">
                    <option value="true">TRUE</option>
                    <option value="false" selected>FALSE</option>
                </select>
                <small>Enable HW signal routing calibration</small>
            </div>

            <div class="form-group">
                <label for="rba_IoSigDio_CalibAlterText">Calibration Alternate Text:</label>
                <input type="text" id="rba_IoSigDio_CalibAlterText" name="calibAlterText" 
                    maxlength="32" placeholder="A2L alternate text">
                <small>Alternate text for A2L file (1-32 chars)</small>
            </div>
            
            <div class="form-group">
                <label for="rba_IoSigDio_CalibratableInvert">Calibration Inversion Support:</label>
                <select id="rba_IoSigDio_CalibratableInvert" name="calibratableInvert">
                    <option value="true">TRUE</option>
                    <option value="false" selected>FALSE</option>
                </select>
                <small>Enable signal inversion calibration</small>
            </div>
        </div>
        
        <div class="collapsible-header" data-target="initialization-settings">
            <h4>Initialization Settings <span class="toggle-icon">▼</span></h4>
        </div>
        <div class="collapsible-content collapsed" id="initialization-settings">
            <div class="form-group">
                <label for="rba_IoSigDio_InitState">Initial State:</label>
                <select id="rba_IoSigDio_InitState" name="initState">
                    <option value="Idle" selected>Idle</option>
                    <option value="Active">Active</option>
                </select>
                <small>Signal state after initialization</small>
            </div>
            
            <div class="form-group">
                <label for="rba_IoSigDio_InitStrategy">Initialization Strategy:</label>
                <select id="rba_IoSigDio_InitStrategy" name="initStrategy">
                    <option value="AnyReset" selected>Any Reset</option>
                    <option value="PwrOnReset">Power-On Reset</option>
                </select>
                <small>When to re-initialize signal</small>
            </div>
        </div>
        
        <div class="collapsible-header" data-target="diagnostic-protection">
            <h4>Diagnostic & Protection <span class="toggle-icon">▼</span></h4>
        </div>
        <div class="collapsible-content collapsed" id="diagnostic-protection">
            <div class="form-group">
                <label for="rba_IoSigDio_OutDiagCurrent">Output Diagnostic Current:</label>
                <select id="rba_IoSigDio_OutDiagCurrent" name="outDiagCurrent">
                    <option value="true">TRUE</option>
                    <option value="false" selected>FALSE</option>
                </select>
                <small>Enable diagnostic current for power stages</small>
            </div>
            
            <div class="form-group">
                <label for="rba_IoSigDio_OutProtectStrategy">Output Protection Strategy:</label>
                <select id="rba_IoSigDio_OutProtectStrategy" name="outProtectStrategy">
                    <option value="">Not Specified</option>
                    <option value="SwitchOff" selected>Switch-Off</option>
                    <option value="CurrentLimit">Current Limitation</option>
                    <option value="NoProtect">No Protection</option>
                </select>
                <small>Overload protection behavior</small>
            </div>

            <div class="form-group">
                <label for=""></label>
                <select id="" name="">
                    <option value=""></option>
                </select>
                <small></small>
            </div>
        </div>
        
        <div class="button-row">
            <button type="button" class="btn btn-primary" onclick="saveAdvancedConfig('${config.pin}')">💾 Save Configuration</button>
            <button type="button" class="btn btn-secondary" onclick="loadDefaultConfig()">📁 Load Default</button>
            <button type="button" class="btn btn-info" onclick="validateConfig()">✓ Validate</button>
            <button type="button" class="btn btn-success" onclick="exportARXML('${config.pin}')">📤 Export AUTOSAR</button>
        </div>
    </div>
</body>
<script>
    initializeCollapsibles();

    function initializeCollapsibles() {
            document.querySelectorAll('.collapsible-header').forEach(header => {
                header.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const content = document.getElementById(targetId);
                    
                    if (content) {
                        content.classList.toggle('collapsed');
                        this.classList.toggle('collapsed');
                    }
                });
            });
        }
</script>
</html>
